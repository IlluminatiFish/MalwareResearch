


Youtube Video URL: https://www.youtube.com/watch?v=QTbbZQ2i7gQ

Backstory: 

From the video we can see its a tyipcal nitro generator scam, however
looking further into it, it made my intial observation incorrect so I decided to dig further..

The description gives us a download link to the supposed generator as seen below:

Download: https://anonfiles.com/pcXba49aue/GENERATOR_zip


After going to the download url, and downloading the zip file when we open the folder we get greeted with the following files inside the zip file


```

GENERATOR
- lib
- Generator.exe
- nitro.txt
- python3.dll
- python39.dll
```

Once then Generator.exe was extracted out of the zip file, I used strings on the file and found the following interesting strings

Potential IOCs:

```
https://arsenite.su/logger/
https://cdn.discordapp.com/attachments/847494890183065625/861305178968162314/Update.exe
https://cdn.discordapp.com/attachments/847494890183065625/861305480437170206/Newtonsoft.Json.dll
```

Also from the strings we can a sample of javascript-related strings that seem to be injecting into discord's internals used for persistence without the victim knowing:


```
const 
child_process = require('child_process')
child_process.execSync(
	"${__dirname}//Update.exe"
require(
	${__dirname}//inject.js
module.exports = require('./core.asar')
```

Other suspicious strings that were found: 

```
LOCALAPPDATA
Installation:
APPDATA
cmdtaskkill /f /im
--processStart
Google/Chrome/User Data/Default
BraveSoftware/Brave-Browser/User Data/Default
Local Storage/leveldb
Tokens:
Path:
struct ArseniteError
struct ArseniteRatelimit
disable_2faversions
discord_desktop_core
DiscordCanary
https://discord.com/api/v8/users/@me
```

From these strings I can conclude the following things;

- The stealer is called 'Arsenite'
- This is a token stealer for both desktop and browser versions of Discord
- Disables 2fa on a token (?)
- Attempts to persist on the victim's machine by injecting its own Update.exe into discord's startup files using JavaScript
- Exfiltrates stolen data through C2 url ``https://arsenite.su/logger/`` 

I then decided to run it through VT and it came out 5/69 vendors detecting it as malicious 


After finding some of the strings I decided to google the C2 url and came upon a repository that has the source code for this discord token stealer, and after skimming through it, I can confidently say that the stolen data gets reported back to ``https://arsenite.su/logger/{Config.Id}/report`` via a POST request, if the silent config setting is enabled, other parts of the stealer's config include the reporting endpoint id and whether it should disable 2fa for the token


Looking at the domain ``arsenite.su``, its been up for 28 days behind cloudflare of course


After executing strings on the Update.exe that was found to be hardcoded into the stealer I found the folllowing:


``
D:\repos\Arsenite\Update\obj\Debug\Update.pdb
223d397e-dec8-4e87-a3cc-729f94285576
password
versions
file
version
id
disable_2fa
https://arsenite.su//cdn/stub/versions.json
``

Seems that the ``disable_2fa`` setting from the initial executable is used in the Update.exe to signify whether it will disable the victim's 2fa for their discord account.
