rule ArseniteStealer : Discord_Token_Stealer {

    meta:
        author = "IlluminatiFish"
        description = "A rule to detect the main executable of the C# discord token stealer called Arsenite"
        created = "31-07-2021"
        last_modified = "31-07-2021"
       
    strings:
    	$ioc = "https://cdn.discordapp.com/attachments/847494890183065625/861305480437170206/Newtonsoft.Json.dll"
        $persistence = "https://cdn.discordapp.com/attachments/847494890183065625/861305178968162314/Update.exe"
        $c2_url = "https://arsenite.su/logger/"


        // Distinctive strings from the sample that could be used to detect Arsenite too..
        $s0 = "LOCALAPPDATA"
        $s1 = "APPDATA"
        $s2 = "Local Storage/leveldb"
        $s3 = "struct ArseniteError"
        $s4 = "struct ArseniteRatelimit"
        $s5 = "discord_desktop_core"
        $s6 = "DiscordCanary"
        $s7 = "Path:"
        $s8 = "Token:"
        $s9 = "Installation:"


    condition:
        ($ioc and $persistence and $c2_url) and any of ($s*)
}


rule ArsenitePersistence : Discord_Token_Stealer {

    meta:
        author = "IlluminatiFish"
        description = "A rule to detect the persistence executable that is hardcoded in the main Arsenite executable"
        created = "31-07-2021"
        last_modified = "31-07-2021"
       
    strings:
        $pdb_path = "D:\\repos\\Arsenite\\Update\\obj\\Debug\\Update.pdb"

        $s0 = "223d397e-dec8-4e87-a3cc-729f94285576"
        $s1 = "https://arsenite.su//cdn/stub/versions.json"
        $s2 = "disable_2fa"
        $s3 = "password"
        $s4 = "versions"
        $s5 = "file"
        $s6 = "id"


    condition:
        $pdb_path and any of ($s*)
}
